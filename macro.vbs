Sub GenerateShopifyCSV()    Dim rows As Integer    rows = Worksheets("Products").Range("A1").End(xlDown).row    Dim shopifyRow As Integer    shopifyRow = 2    With Worksheets("Shopify CSV file")        Range(.Range("A1"), .UsedRange).Offset(1, 0).Delete Shift:=xlToLeft    End With    For row = 2 To rows        'Code for generating tag string comma separated        Dim tags As String        tags = "color:" & Worksheets("Products").Range("J" & row).Value & ","        Dim startingCol As String        startingCol = "K"        Dim filterIconTags(5)        filterIconTags(0) = "cotton"        filterIconTags(1) = "silk"        filterIconTags(2) = "handloom"        filterIconTags(3) = "zari"        filterIconTags(4) = "embroidery"        For f = 0 To 4          Dim val As String          val = Worksheets("Products").Range(Chr(Asc("K") + f) & row).Value          If val = "Yes" Then            tags = tags & filterIconTags(f) & ","          End If          'startingCol = Chr(Asc(startingCol) + 1)        Next f        'startingCol = "P"        Dim detailTags(8) As String        detailTags(0) = "Highlight"        detailTags(1) = "Fabric"        detailTags(2) = "Colour"        detailTags(3) = "Print"        detailTags(4) = "Embroidery/ work"        detailTags(5) = "Pallu"        detailTags(6) = "Occasion"        detailTags(7) = "Fabric & care"        For f = 0 To 7          Dim value As String          value = Worksheets("Products").Range(Chr(Asc("P") + f) & row).Value          value = Trim(value)          If Len(value) > 0 Then            tags = tags & "detail-" & Chr(Asc("a") + f) & "-" & detailTags(f) & ":" & value & ","          End If        Next f        'Copy tags        Worksheets("Shopify CSV file").Range("F" & shopifyRow) = tags        'Copy handle, title, vendor, weight, SKU, price, Type, Inventory Qty as is        Worksheets("Shopify CSV file").Range("A" & shopifyRow) = Worksheets("Products").Range("A" & row).Value        Worksheets("Shopify CSV file").Range("B" & shopifyRow) = Worksheets("Products").Range("B" & row).Value        Worksheets("Shopify CSV file").Range("D" & shopifyRow) = Worksheets("Products").Range("D" & row).Value        Worksheets("Shopify CSV file").Range("O" & shopifyRow) = Worksheets("Products").Range("E" & row).Value        Worksheets("Shopify CSV file").Range("N" & shopifyRow) = Worksheets("Products").Range("F" & row).Value        Worksheets("Shopify CSV file").Range("T" & shopifyRow) = Worksheets("Products").Range("G" & row).Value        Worksheets("Shopify CSV file").Range("E" & shopifyRow) = Worksheets("Products").Range("H" & row).Value        Worksheets("Shopify CSV file").Range("Q" & shopifyRow) = Worksheets("Products").Range("I" & row).Value        'Fixed strings for Published, Variant Inventory Tracker, Variant Inventory Policy,        'Variant fulfillment service, Variant Requires Shipping, Variant Taxable        Worksheets("Shopify CSV file").Range("G" & shopifyRow) = TRUE        Worksheets("Shopify CSV file").Range("P" & shopifyRow) = "shopify"        Worksheets("Shopify CSV file").Range("R" & shopifyRow) = "deny"        Worksheets("Shopify CSV file").Range("S" & shopifyRow) = "manual"        Worksheets("Shopify CSV file").Range("V" & shopifyRow) = TRUE        Worksheets("Shopify CSV file").Range("W" & shopifyRow) = TRUE        'Generate body html and copy        Dim desc As String        desc = "<div>What makes this sari a treasure?</div><div>"        desc = desc & Worksheets("Products").Range("C" & row).Value & "</div>"        Worksheets("Shopify CSV file").Range("C" & shopifyRow) = desc        shopifyRow = shopifyRow + 1        'Code for image rows        Dim handle As String        handle = Worksheets("Products").Range("A" & row).Value        Dim a As Integer        a = Worksheets("Images").Range("A1").End(xlDown).row        With Worksheets("Images").Range("A1:A" & a)          Set c = .Find(handle)          If Not c Is Nothing Then            firstAddress = c.Address            Do              Worksheets("Shopify CSV file").Range("A" & shopifyRow) = handle              Worksheets("Shopify CSV file").Range("Y" & shopifyRow) = c.Offset(0,1).Value              shopifyRow = shopifyRow + 1              Set c = .FindNext(c)            Loop While Not c Is Nothing And c.Address <> firstAddress          End If        End With    Next rowEnd Sub